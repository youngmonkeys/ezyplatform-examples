<!DOCTYPE html>
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{ezytheme}">
<body>
<div layout:fragment="content">
    <div class="hero">
        <div class="container">
            <div class="left">
                <h1 class="h1">
                    <th:block th:if="${headingFragments.get('description').title != 'description'}"
                              th:utext="${headingFragments.get('description').title}">
                    </th:block>
                </h1>
                <p class="h3">
                    <th:block th:if="${headingFragments.get('description').content != 'description'}"
                              th:utext="${headingFragments.get('description').content}">
                    </th:block>
                </p>
                <div class="btn-group">
                    <a href="/contact-us" class="btn btn-primary">[[#{contact}]]</a>
                    <a href="/about-us" class="btn btn-secondary">[[#{about_me}]]</a>
                </div>
            </div>
            <div class="right">
                <div class="pattern-bg"></div>
                <div class="img-box">
                    <img th:src="${!#strings.isEmpty(webBannerImageUrl) ? webBannerImageUrl : '/images/hero.png'}"
                         class="hero-img" th:alt="#{banner}"/>
                    <div class="shape shape-1"></div>
                    <div class="shape shape-2"></div>
                </div>

            </div>
        </div>
    </div>
    <div class="main">
        <div class="container">
            <div class="blog">
                <h2 class="h2">Latest Blog Post</h2>
                <div class="blog-card-group">
                    <th:block th:each="blog : ${pagination.items}">
                        <th:block th:replace="~{fragments/blog-item :: content(blog=${blog})}"></th:block>
                    </th:block>
                </div>
                <button class="btn load-more">Load More</button>
            </div>
            <!--
              - ASIDE
            -->
            <div class="aside">

                <div class="topics">

                    <h2 class="h2">[[#{topics}]]</h2>

                    <a th:each="topCategory : ${topCategories}"
                       th:href="${'/topics/' + topCategory.slug}"
                       class="topic-btn">
                        <div class="icon-box">
                            <img th:if="${topCategory.titleImage != null}"
                                 th:src="${topCategory.titleImage.getUrlOrNull()}">
                        </div>
                        <p>[[${topCategory.name}]]</p>
                    </a>

                </div>

                <div class="tags">

                    <h2 class="h2">Tags</h2>

                    <div class="wrapper">

                        <button th:each="topTag : ${topTags}"
                                type="button" class="hashtag">
                            #[[${topTag.name}]]
                        </button>

                    </div>

                </div>

                <div class="contact">

                    <h2 class="h2">Let's Talk</h2>

                    <div class="wrapper">

                        <p>
                            Do you want to learn more about how I can help your company overcome problems? Let us have a
                            conversation.
                        </p>

                        <ul class="social-link">

                            <li>
                                <a href="#" class="icon-box discord">
                                    <ion-icon name="logo-discord"></ion-icon>
                                </a>
                            </li>

                            <li>
                                <a href="#" class="icon-box twitter">
                                    <ion-icon name="logo-twitter"></ion-icon>
                                </a>
                            </li>

                            <li>
                                <a href="#" class="icon-box facebook">
                                    <ion-icon name="logo-facebook"></ion-icon>
                                </a>
                            </li>

                        </ul>

                    </div>

                </div>

                <div class="newsletter">

                    <h2 class="h2">Newsletter</h2>

                    <div class="wrapper">

                        <p>
                            Subscribe to our newsletter to be among the first to keep up with the latest updates.
                        </p>

                        <form id="subscribeForm" onsubmit="return false;">
                            <input type="email" name="email" th:placeholder="#{email_address}" required
                                   onkeydown="onKeydownToSubscribe();">
                            <button type="button" class="btn btn-primary" onclick="onSubscribeClick();">
                                [[#{subscribe}]]
                            </button>
                        </form>

                    </div>

                </div>

            </div>
        </div>
    </div>
</div>
<script layout:fragment="scripts" th:inline="javascript">
/*<![CDATA[*/
ezyweb.messages.subscribe_successfully = /*[[#{subscribe_successfully}]]*/;
/*]]>*/

var onKeydownToSubscribe = function() {
    if(event.key === 'Enter') {
        onSubscribeClick();
    }
}

var onSubscribeClick = function() {
    var formData = ezyweb.formDataToObject('subscribeForm');
    $.ajax({
        type: 'POST',
        url: '/api/v1/ezycrm/subscribe',
        contentType: 'application/json',
        data: JSON.stringify(formData)
    }).done(function (menu) {
        alert(ezyweb.messages.subscribe_successfully);
    }).fail(function (e) {
        ezyweb.processGetApiErrors(e);
    });
}
</script>
</body>
</html>
